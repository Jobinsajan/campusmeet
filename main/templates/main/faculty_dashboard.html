{% extends "main/faculty_base.html" %}
{% block title %}Faculty Dashboard - CampusMeet{% endblock %}

{% block style %}
<style>
:root {
  --primary-color: #2564cf;
  --gradient-blue: linear-gradient(120deg, #e3f0ff 60%, #b9dcff 100%);
  --gradient-orange: linear-gradient(120deg, #ffe9c5 50%, #ffd8a3 100%);
  --card-shadow: 0 8px 32px rgba(32, 80, 137, 0.12);
  --card-shadow-hover: 0 18px 38px rgba(32, 80, 137, 0.15);
}

body { background: #f5f7fb; }
.dashboard-cards {
  display: flex;
  gap: 2.4rem;
  margin-bottom: 2.7rem;
  flex-wrap: wrap;
}
.dashboard-card {
  flex: 1 1 260px;
  min-width: 260px;
  max-width: 350px;
  background: var(--gradient-blue);
  border-radius: 24px;
  box-shadow: var(--card-shadow);
  position: relative;
  overflow: hidden;
  padding: 2.2rem 2rem 1.7rem 2rem;
  margin-bottom: 1rem;
  transition: box-shadow .22s, transform .17s;
  isolation: isolate;
  border: 2px solid #c6dfff7a;
}
.dashboard-card.card-2 {
  background: var(--gradient-orange);
  border-color: #ffd9ae84;
}
.dashboard-card .card-icon {
  width: 54px;
  height: 54px;
  display: flex;
  align-items: center;
  justify-content: center;
  border-radius: 16px;
  position: absolute; left: 20px; top: 20px;
  font-size: 2.15rem;
  color: #fff;
  box-shadow: 0 2px 10px #aec8e9a7;
  z-index: 2;
}
.dashboard-card.card-2 .card-icon { background: #fdb456; box-shadow: 0 2px 10px #ffd480ae; }
.dashboard-card.card-1 .card-icon { background: #478fd6; }
.dashboard-card h4, .dashboard-card .card-value, .dashboard-card .card-desc {
  margin-left: 76px;
  position: relative;
  z-index: 1;
}
.dashboard-card h4 {
  font-weight: 700;
  font-size: 1.15rem;
  margin-bottom: 0.42rem;
  color: #20408a;
}
.card-value {
  font-size: 2.26rem;
  font-weight: 900;
  color: #2564cf;
  margin-bottom: 0.28rem;
  letter-spacing: -0.5px;
}
.dashboard-card.card-2 .card-value { color: #fe9601; }
.card-desc {
  font-size: 1.01rem;
  color: #4e6785;
  margin-top: -3px;
}
.dashboard-card:hover {
  box-shadow: var(--card-shadow-hover);
  transform: translateY(-7px) scale(1.04);
}
h2.section-title {
  margin-top: 2.2rem;
  margin-bottom: 1.2rem;
  font-weight: 800;
  font-size: 1.44rem;
  letter-spacing: .015em;
  padding-bottom: 8px;
  border-bottom: 2px solid #e3eaf3;
  color: var(--primary-color);
  background: -webkit-linear-gradient(left,#1742af 40%, #3e70d7 100%);
  -webkit-background-clip: text;
  -webkit-text-fill-color: transparent;
}
.table-card {
  background: #fff;
  border-radius: 20px;
  box-shadow: 0 8px 32px rgba(55,98,182,0.10);
  overflow: hidden;
  margin-bottom: 3rem;
  border: 1.3px solid #eaf1fa;
}
.table-card thead th {
  background: linear-gradient(90deg, #e3eaf3 40%, #f3f8ff 100%);
  font-weight: 700;
  color: #1742af;
  font-size: 1.08rem;
  padding: 1.08rem 0.7rem;
  border-right: 2px solid #f5f7fb;
}
.table-card thead th:last-child { border-right: none; }
.table-card tbody tr {
  transition: background .22s;
  background: #fff;
}
.table-card tbody tr:hover {
  background-color: #f1f8ff;
  box-shadow: 0 4px 18px rgba(61,119,224,0.09);
}
.table-card td {
  font-size: 1rem;
  padding: 0.93rem 0.6rem;
  text-align: center;
  border: none;
}
.badge {
  font-size: 0.89rem;
  font-weight: 600;
  padding: 0.38em 1em;
  border-radius: 8px;
  background: #e6ecef;
  color: #525a67;
  margin-right: 4px;
}
.btn-sm {
  font-size: 0.96rem;
  border-radius: 7px;
  padding: 0.39rem 1.12rem;
  box-shadow: 0 1px 5px #e6ecfa66;
}
.btn-outline-primary { border-color: #2771ed; color: #2771ed; background: #f8fbff; }
.btn-outline-primary:hover { background: #2771ed; color: #fff; }
.btn-outline-danger { border-color: #fe5050; color: #fe5050; background: #fdf7f7;}
.btn-outline-danger:hover { background: #fe5050; color: #fff; }
.btn-outline-info { border-color: #1ec6ed; color: #1ec6ed; background: #f4fcfe;}
.btn-outline-info:hover { background: #1ec6ed; color: #fff; }
.btn-outline-success { border-color: #4ae47a; color: #34c34f; background: #f5fff8;}
.btn-outline-success:hover { background: #34c34f; color: #fff; }
.list-group-item {
  font-size: 1.09rem;
  border-radius: 10px !important;
  margin-bottom: 4px;
  box-shadow: 0 2px 10px rgba(110, 140, 187, 0.06);
}
</style>
{% endblock %}

{% block content %}
<h1 class="mb-4">Faculty Dashboard</h1>

<div class="dashboard-cards">
  <div class="dashboard-card card-1">
    <div class="card-icon">&#128218;</div>
    <h4>Total Subjects</h4>
    <div class="card-value">{{ subjects|length }}</div>
    <div class="card-desc">Activated subjects</div>
  </div>
  <div class="dashboard-card card-2">
    <div class="card-icon">&#128196;</div>
    <h4>Notes Uploaded</h4>
    <div class="card-value">{{ notes|length }}</div>
    <div class="card-desc">Latest: {% if notes %}{{ notes.0.title }}{% else %}None{% endif %}</div>
  </div>
</div>

<h2 class="section-title">Meetings & Attendance</h2>
<div class="table-responsive">
  <table class="table-card w-100">
    <thead>
      <tr>
        <th>Subject</th>
        <th>Scheduled Date &amp; Time</th>
        <th>Status</th>
        <th>Actions</th>
      </tr>
    </thead>
    <tbody>
      {% for meeting in meetings %}
      <tr>
        <td>{{ meeting.subject.name }}</td>
        <td>{{ meeting.schedule_datetime }}</td>
        <td>
          {% if meeting.schedule_datetime < current_time %}
            <span class="badge bg-secondary">Past</span>
          {% else %}
            <span class="badge bg-success">Upcoming</span>
          {% endif %}
        </td>
        <td>
          <a href="{% url 'edit_meeting' meeting.id %}" class="btn btn-sm btn-outline-primary">Edit</a>
          <a href="{% url 'delete_meeting' meeting.id %}" class="btn btn-sm btn-outline-danger">Del</a>
          <a href="{% url 'meeting_attendance' meeting.id %}" class="btn btn-sm btn-outline-info">View Attendance</a>
          {% if meeting.video_room_link and meeting.schedule_datetime.date == current_time.date %}
            <a href="{{ meeting.video_room_link }}" target="_blank" class="btn btn-sm btn-outline-success">Start</a>
          {% endif %}
        </td>
      </tr>
      {% empty %}
      <tr>
        <td colspan="4" class="text-center py-4 text-muted">No meetings scheduled.</td>
      </tr>
      {% endfor %}
    </tbody>
  </table>
</div>

<h2 class="section-title">Your Subjects</h2>
<ul class="list-group mb-4" role="list">
  {% for subject in subjects %}
    <li class="list-group-item" role="listitem">{{ subject.name }}</li>
  {% empty %}
    <li class="list-group-item text-muted" role="listitem">No subjects assigned yet.</li>
  {% endfor %}
</ul>

<h2 class="section-title">Notes</h2>
<a href="{% url 'create_note' %}" class="btn btn-primary btn-lg mb-3">Upload New Note</a>
<div class="table-responsive">
  <table class="table-card w-100">
    <thead>
      <tr>
        <th>Title</th>
        <th>Subject</th>
        <th>Created At</th>
        <th>Actions</th>
      </tr>
    </thead>
    <tbody>
      {% for note in notes %}
      <tr>
        <td>{{ note.title }}</td>
        <td>{{ note.subject.name }}</td>
        <td>{{ note.created_at|date:'Y-m-d H:i' }}</td>
        <td>
          <a href="{% url 'edit_note' note.id %}" class="btn btn-sm btn-outline-primary">Edit</a>
          <a href="{% url 'delete_note' note.id %}" class="btn btn-sm btn-outline-danger">Delete</a>
        </td>
      </tr>
      {% empty %}
      <tr>
        <td colspan="4" class="text-center text-muted py-4">No notes available.</td>
      </tr>
      {% endfor %}
    </tbody>
  </table>
</div>
<script src="https://cdn.jsdelivr.net/npm/bootstrap/dist/js/bootstrap.bundle.min.js"></script>
{% endblock %}
